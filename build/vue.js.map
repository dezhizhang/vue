{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/observer/dep.js","../src/observer/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/index.js","../src/vdom/index.js","../src/lifecycle.js","../src/init.js","../src/index.js"],"sourcesContent":["\nlet oldArrayProto = Array.prototype;\n\nexport let newArrayProto = Object.create(oldArrayProto);\n\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'resolve',\n    'sort',\n    'splice'\n];\n\n\nmethods.forEach(method => {\n    newArrayProto[method] = function (...args) {\n        const result = oldArrayProto[method].call(this, ...args);\n\n        // 新增数据进行却持\n        let inserted;\n        let ob = this.__ob__;\n\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n            default:\n                break;\n        }\n\n        if(inserted) {\n            ob.observeArray(inserted);\n        }\n    }\n})","\nlet id = 0;\nclass Dep{\n    constructor() {\n        this.id = id++;\n        this.subs = [];\n    }\n    depend() {\n        this.subs.push(Dep.target);\n    }\n}\n\nDep.target = null;\n\nexport default Dep;\n","\nimport { newArrayProto } from './array';\nimport Dep from './dep';\nclass Observer {\n    constructor(data) {\n        Object.defineProperty(data, '__ob__', {\n            value: this,\n            enumerable: false,\n        });\n        if (Array.isArray(data)) {\n            data.__proto__ = newArrayProto;\n            this.observeArray(data);\n        } else {\n            this.walk(data);\n        }\n\n    }\n\n    walk(target) {\n        Object.keys(target).forEach(key => {\n            defineReactive(target, key, target[key]);\n        })\n    }\n    observeArray(data) {\n        data.forEach(item => observe(item))\n    }\n}\n\nfunction defineReactive(target, key, value) {\n    observe(value);\n    let dep = new Dep();\n\n    Object.defineProperty(target, key, {\n        get() {\n            if(Dep.target) {\n                dep.depend();\n            }\n            return value;\n        },\n        set(newValue) {\n            if (newValue === value) return;\n            observe(newValue);\n            value = newValue;\n        }\n    })\n}\n\nexport function observe(data) {\n    if (typeof data !== 'object' || data == null) {\n        return; // 不是对像不能观测\n    }\n    if (data._ob_ instanceof Observer) {\n        return data._ob_;\n    }\n    return new Observer(data);\n}","\nimport { observe } from './observer/index';\n\nexport function initState(vm) {\n    // 获取所有的选项\n    const opt = vm.$options;\n    if(opt.data) {\n        initData(vm)\n    }\n}\n\nexport function initData(vm) {\n    let data = vm.$options.data;\n    data = vm._data = typeof data === 'function' ? data.call(vm):data;\n    observe(data);\n}","\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\nconst startTagClose = /^\\s*(\\/?)>/;\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\n\nexport function parseHTML(html) {\n    const ELEMENT_TYPE = 1;\n    const TEXT_TYPE = 3;\n    let stack = [];\n    let currentParent;\n    let root;\n\n\n    // 转换成语法树\n    function createAstElement(tag, attrs) {\n        return {\n            tag,\n            type: ELEMENT_TYPE,\n            children: [],\n            attrs,\n            parent: null,\n        }\n    }\n\n    function start(tag, attrs) {\n        let node = createAstElement(tag, attrs);\n        if (!root) {\n            root = node;\n        }\n\n        if (currentParent) {\n            node.parent = currentParent;\n            currentParent.children.push(node);\n        }\n        stack.push(node);\n        currentParent = node;\n    }\n\n    function chars(text) {\n        text = text.replace(/\\s/g,'')\n        text && currentParent.children.push({\n            type: TEXT_TYPE,\n            text,\n            parent:currentParent,\n        });\n    }\n\n    function end(tag) {\n       let node = stack.pop();\n       currentParent = stack[stack.length - 1];\n    }\n\n\n    function advance(n) {\n        html = html.substring(n);\n    }\n    function parseStartTag() {\n        const start = html.match(startTagOpen);\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: [],\n            }\n            advance(start[1].length);\n\n            let attr, end;\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                advance(attr[0].length);\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\n            }\n\n            if (end) {\n                advance(end[0].length);\n            }\n            return match;\n\n        }\n        return false;\n    }\n    while (html) {\n        let textEnd = html.indexOf('<');\n        if (textEnd === 0) {\n            const startTagMatch = parseStartTag();\n            if (startTagMatch) {\n                start(startTagMatch)\n                continue;\n            }\n            let endTagMatch = html.match(endTag);\n            if (endTag) {\n                advance(endTagMatch[0].length);\n                continue\n            }\n            break;\n        }\n        if (textEnd > 0) {\n            let text = html.substring(0, textEnd);\n            if (text) {\n                advance(text.length);\n            }\n        }\n    }\n   return root;\n}\n","import { parseHTML } from './parse';\n\nconst defaultTagReg = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\n\nfunction genProps(attrs) {\n    let str = '';\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i];\n        if (attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item => {\n                let [key, value] = item.split(':');\n                obj[key] = value;\n            });\n            attr.value = obj;\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\n    }\n    return `{${str.slice(0, -1)}}`;\n}\n\n\nfunction gen(node) {\n    if(node.type === 1) {\n        return codeGen(node);\n    }else {\n        const text = node.text;\n        if(!defaultTagReg.test(text)) {\n            return `_c(${JSON.stringify(text)})`;\n        }else {\n            let tokens = [];\n            let match;\n            defaultTagReg.lastIndex = 0;\n            let lastIndex = 0;\n            while(defaultTagReg.exec(text)) {\n                let index = match.index;\n                if(index > lastIndex) {\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n                }\n                tokens.push(`_s${match[1].trim()}`);\n                lastIndex = index + match[0].length;\n            }\n\n            if(lastIndex < text.length) {\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\n            }\n\n            return `_v(${tokens.join('+')})`\n        }\n    }\n}\n\nfunction genChildren(children) {\n    if(children) {\n        return children.map(child => gen(child)).join(',')\n    }\n}\n\n\nfunction codeGen(ast) {\n    let children = genChildren(ast.children);\n    let code = `_c('${ast.tag.tagName}',${ast.tag.attrs.length > 0 ? genProps(ast.tag.attrs) : 'null'},${ast.children.length ? children : ''})`;\n    return code;\n}\n\nexport function compileToFunction(template) {\n   \n    let ast = parseHTML(template);\n  \n    let code = codeGen(ast);\n    code = `with(this){return  ${code}}`;\n    let render = new Function(code)\n    console.log('ast',render);\n}","\n\n\nexport function createElementVNode(vm,tag,data={},...children) {\n    let key = data.key;\n    if(key) {\n        delete data.key\n    }\n    return vnode(vm,tag,key,data,children)\n}\n\n\nexport function createTextNode(vm,text) {\n    return vnode(vm,undefined,undefined,undefined,undefined,text)\n}\n\nfunction vnode(vm,tag,key,data,children,text) {\n    return {\n        vm,\n        tag,\n        key,\n        data,\n        children,\n        text\n    }\n}","\nimport {createElementVNode,createTextNode} from './vdom/index';\n\n\nfunction createElm(vnode) {\n    const { tag,data,children,text} = vnode;\n    if(typeof tag === 'string') {\n        vnode.el = document.createElement(tag);\n        patchProps(vnode.el,data);\n        children.forEach(child => {\n            vnode.el.appendChild(createElm(child));\n        })\n    }else{\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el;\n}\n\nfunction patchProps(el,props) {\n    for(let key in props) {\n        if(key ==='style') {\n            for(let styleName in props.style) {\n                el.style[styleName] = props.style[styleName];\n            }\n        }else {\n            el.setAttribute(key,props[key])\n        }\n    }\n}\n\n\nfunction patch(oldVnode,vnode) {\n    // 初次渲染\n    const isRealElement = oldVnode && oldVnode.nodeType;\n    if(isRealElement) {\n        const elm = oldVnode;\n        const parentElm = elm.parentNode;\n        let newElm = createElm(vnode);\n        parentElm.insertBefore(newElm,elm.nextSibling);\n        parentElm.removeChild(elm);\n    }else {\n        //diff算法\n    }\n}\n\nexport function initLifeCycle(Vue) {\n    Vue.prototype._update = function(vnode) {\n       const vm = this;\n       const el = vm.$el;\n       patch(el,vnode);\n       \n    }\n\n    Vue.prototype._c = function() {\n        return createElementVNode(this,...arguments);\n    }\n\n    Vue.prototype._v = function() {\n        return createTextNode(this,...arguments);\n    }\n\n    Vue.prototype._s = function(value) {\n        if(typeof value!=='object') return value;\n        return JSON.stringify(value);\n    }\n\n    Vue.prototype._render = function() {\n        return this.$options.render.call(this);\n    }\n}\n\n \nexport function mountComponent(vm,el) {\n    vm.$el = el;\n    vm._update(vm._render())\n}","import { initState } from './state';\nimport { compileToFunction } from './compiler/index';\nimport { mountComponent } from './lifecycle';\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n\n        const vm = this;\n        vm.$options = options;\n\n        // 初始化状态\n        initState(vm);\n\n        // 初始化模板\n        if(options.el) {\n            vm.$mount(options.el);\n        }\n    }\n\n    Vue.prototype.$mount = function(el) {\n        const vm = this;\n        const opt = vm.$options;\n        el = document.querySelector(el);\n        if(!opt.render) {\n            let template;\n            if(!opt.template && el) {\n                template = el.outerHTML;\n            }else{\n                if(el) {\n                    template = opt.template;\n                }\n            }\n            if(template) {\n                compileToFunction(template);\n                opt.render = render;\n\n            }\n        }\n        mountComponent(vm,el)\n    }\n}\n\n","\nimport { initMixin } from './init';\n\nimport { initLifeCycle } from './lifecycle';\n\nfunction Vue(options) {\n   this._init(options);\n}\n\ninitMixin(Vue);\ninitLifeCycle(Vue);\n\nexport default Vue;\n"],"names":["oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","slice","observeArray","id","Dep","subs","push","target","Observer","data","defineProperty","value","enumerable","isArray","__proto__","walk","keys","key","defineReactive","item","observe","dep","get","depend","set","newValue","_ob_","initState","vm","opt","$options","initData","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","startTagClose","attribute","parseHTML","html","ELEMENT_TYPE","currentParent","root","createAstElement","tag","attrs","type","children","parent","start","node","advance","n","substring","parseStartTag","match","tagName","length","attr","end","name","textEnd","indexOf","startTagMatch","endTagMatch","text","defaultTagReg","genProps","str","i","obj","split","JSON","stringify","gen","codeGen","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","child","ast","code","compileToFunction","template","render","Function","console","log","createElementVNode","vnode","createTextNode","undefined","createElm","el","document","createElement","patchProps","appendChild","props","styleName","style","setAttribute","patch","oldVnode","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibling","removeChild","initLifeCycle","Vue","_update","$el","_c","arguments","_v","_s","_render","mountComponent","initMixin","_init","options","$mount","querySelector","outerHTML"],"mappings":"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"}