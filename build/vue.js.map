{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/index.js","../src/vdom/index.js","../src/lifecycle.js","../src/init.js","../src/index.js"],"sourcesContent":["\nlet oldArrayProto = Array.prototype;\n\nexport let newArrayProto = Object.create(oldArrayProto);\n\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'resolve',\n    'sort',\n    'splice'\n];\n\n\nmethods.forEach(method => {\n    newArrayProto[method] = function (...args) {\n        const result = oldArrayProto[method].call(this, ...args);\n\n        // 新增数据进行却持\n        let inserted;\n        let ob = this.__ob__;\n\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n            default:\n                break;\n        }\n\n        if(inserted) {\n            ob.observeArray(inserted);\n        }\n    }\n})","\nimport { newArrayProto } from './array';\nclass Observer {\n    constructor(data) {\n        Object.defineProperty(data, '__ob__', {\n            value: this,\n            enumerable: false,\n        });\n        if (Array.isArray(data)) {\n            data.__proto__ = newArrayProto;\n            this.observeArray(data);\n        } else {\n            this.walk(data);\n        }\n\n    }\n\n    walk(target) {\n        Object.keys(target).forEach(key => {\n            defineReactive(target, key, target[key]);\n        })\n    }\n    observeArray(data) {\n        data.forEach(item => observe(item))\n    }\n}\n\nfunction defineReactive(target, key, value) {\n    observe(value);\n    Object.defineProperty(target, key, {\n        get() {\n            return value;\n        },\n        set(newValue) {\n            if (newValue === value) return;\n            observe(newValue);\n            value = newValue;\n        }\n    })\n}\n\nexport function observe(data) {\n    if (typeof data !== 'object' || data == null) {\n        return; // 不是对像不能观测\n    }\n    if (data._ob_ instanceof Observer) {\n        return data._ob_;\n    }\n    return new Observer(data);\n}","\nimport { observe } from './observer/index';\n\nexport function initState(vm) {\n    // 获取所有的选项\n    const opt = vm.$options;\n    if(opt.data) {\n        initData(vm)\n    }\n}\n\nexport function initData(vm) {\n    let data = vm.$options.data;\n    data = vm._data = typeof data === 'function' ? data.call(vm):data;\n    observe(data);\n}","\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\nconst startTagClose = /^\\s*(\\/?)>/;\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\n\nexport function parseHTML(html) {\n    const ELEMENT_TYPE = 1;\n    const TEXT_TYPE = 3;\n    let stack = [];\n    let currentParent;\n    let root;\n\n\n    // 转换成语法树\n    function createAstElement(tag, attrs) {\n        return {\n            tag,\n            type: ELEMENT_TYPE,\n            children: [],\n            attrs,\n            parent: null,\n        }\n    }\n\n    function start(tag, attrs) {\n        let node = createAstElement(tag, attrs);\n        if (!root) {\n            root = node;\n        }\n\n        if (currentParent) {\n            node.parent = currentParent;\n            currentParent.children.push(node);\n        }\n        stack.push(node);\n        currentParent = node;\n    }\n\n    function chars(text) {\n        text = text.replace(/\\s/g,'')\n        text && currentParent.children.push({\n            type: TEXT_TYPE,\n            text,\n            parent:currentParent,\n        });\n    }\n\n    function end(tag) {\n       let node = stack.pop();\n       currentParent = stack[stack.length - 1];\n    }\n\n\n    function advance(n) {\n        html = html.substring(n);\n    }\n    function parseStartTag() {\n        const start = html.match(startTagOpen);\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: [],\n            }\n            advance(start[1].length);\n\n            let attr, end;\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                advance(attr[0].length);\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\n            }\n\n            if (end) {\n                advance(end[0].length);\n            }\n            return match;\n\n        }\n        return false;\n    }\n    while (html) {\n        let textEnd = html.indexOf('<');\n        if (textEnd === 0) {\n            const startTagMatch = parseStartTag();\n            if (startTagMatch) {\n                start(startTagMatch)\n                continue;\n            }\n            let endTagMatch = html.match(endTag);\n            if (endTag) {\n                advance(endTagMatch[0].length);\n                continue\n            }\n            break;\n        }\n        if (textEnd > 0) {\n            let text = html.substring(0, textEnd);\n            if (text) {\n                advance(text.length);\n            }\n        }\n    }\n   return root;\n}\n","import { parseHTML } from './parse';\n\nconst defaultTagReg = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\n\nfunction genProps(attrs) {\n    let str = '';\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i];\n        if (attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item => {\n                let [key, value] = item.split(':');\n                obj[key] = value;\n            });\n            attr.value = obj;\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\n    }\n    return `{${str.slice(0, -1)}}`;\n}\n\n\nfunction gen(node) {\n    if(node.type === 1) {\n        return codeGen(node);\n    }else {\n        const text = node.text;\n        if(!defaultTagReg.test(text)) {\n            return `h(${JSON.stringify(text)})`;\n        }else {\n            let tokens = [];\n            let match;\n            defaultTagReg.lastIndex = 0;\n            let lastIndex = 0;\n            while(defaultTagReg.exec(text)) {\n                let index = match.index;\n                if(index > lastIndex) {\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n                }\n                tokens.push(`_${match[1].trim()}`);\n                lastIndex = index + match[0].length;\n            }\n\n            if(lastIndex < text.length) {\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\n            }\n\n            return `_v(${tokens.join('+')})`\n        }\n    }\n}\n\nfunction genChildren(children) {\n    if(children) {\n        return children.map(child => gen(child)).join(',')\n    }\n}\n\n\nfunction codeGen(ast) {\n    let children = genChildren(ast.children);\n    let code = `h('${ast.tag.tagName}',${ast.tag.attrs.length > 0 ? genProps(ast.tag.attrs) : 'null'},${ast.children.length ? children : ''})`;\n    return code;\n}\n\nexport function compileToFunction(template) {\n   \n    let ast = parseHTML(template);\n  \n    let code = codeGen(ast);\n    code = `with(this){return  ${code}}`;\n    let render = new Function(code)\n    console.log('ast',render);\n}","\n\n\nexport function createElementVNode(vm,tag,data={},...children) {\n    let key = data.key;\n    if(key) {\n        delete data.key\n    }\n    return vnode(vm,tag,key,data,children)\n}\n\n\nexport function createTextNode(vm,text) {\n    return vnode(vm,undefined,undefined,undefined,undefined,text)\n}\n\nfunction vnode(vm,tag,key,data,children,text) {\n    return {\n        vm,\n        tag,\n        key,\n        data,\n        children,\n        text\n    }\n}","\nimport {createElementVNode,createTextNode} from './vdom/index';\n\n\nfunction createElm(vnode) {\n    const { tag,data,children,text} = vnode;\n    if(typeof tag === 'string') {\n        vnode.el = document.createElement(tag);\n        patchProps(vnode.el,data);\n        children.forEach(child => {\n            vnode.el.appendChild(createElm(child));\n        })\n    }else{\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el;\n}\n\nfunction patchProps(el,props) {\n    for(let key in props) {\n        if(key ==='style') {\n            for(let styleName in props.style) {\n                el.style[styleName] = props.style[styleName];\n            }\n        }else {\n            el.setAttribute(key,props[key])\n        }\n    }\n}\n\n\nfunction patch(oldVnode,vnode) {\n    // 初次渲染\n    const isRealElement = oldVnode && oldVnode.nodeType;\n    if(isRealElement) {\n        const elm = oldVnode;\n        const parentElm = elm.parentNode;\n        let newElm = createElm(vnode);\n        parentElm.insertBefore(newElm,elm.nextSibling);\n        parentElm.removeChild(elm);\n    }else {\n        //diff算法\n    }\n}\n\nexport function initLifeCycle(Vue) {\n    Vue.prototype._update = function(vnode) {\n       const vm = this;\n       const el = vm.$el;\n       patch(el,vnode);\n       \n    }\n\n    Vue.prototype._c = function() {\n        return createElementVNode(this,...arguments);\n    }\n\n    Vue.prototype._v = function() {\n        return createTextNode(this,...arguments);\n    }\n\n    Vue.prototype._s = function(value) {\n        if(typeof value!=='object') return value;\n        return JSON.stringify(value);\n    }\n\n    Vue.prototype._render = function() {\n        return this.$options.render.call(this);\n    }\n}\n\n \nexport function mountComponent(vm,el) {\n    vm._update(vm._render())\n}","import { initState } from './state';\nimport { compileToFunction } from './compiler/index';\nimport { mountComponent } from './lifecycle';\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n\n        const vm = this;\n        vm.$options = options;\n\n        // 初始化状态\n        initState(vm);\n\n        // 初始化模板\n        if(options.el) {\n            vm.$mount(options.el);\n        }\n    }\n\n    Vue.prototype.$mount = function(el) {\n        const vm = this;\n        const opt = vm.$options;\n        el = document.querySelector(el);\n        if(!opt.render) {\n            let template;\n            if(!opt.template && el) {\n                template = el.outerHTML;\n            }else{\n                if(el) {\n                    template = opt.template;\n                }\n            }\n            if(template) {\n                compileToFunction(template);\n                opt.render = render;\n\n            }\n        }\n        mountComponent(vm,el)\n    }\n}\n\n","\nimport { initMixin } from './init';\n\nimport { initLifeCycle } from './lifecycle';\n\nfunction Vue(options) {\n   this._init(options);\n}\n\ninitMixin(Vue);\ninitLifeCycle(Vue);\n\nexport default Vue;\n"],"names":["oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","slice","observeArray","Observer","data","defineProperty","value","enumerable","isArray","__proto__","walk","target","keys","key","defineReactive","item","observe","get","set","newValue","_ob_","initState","vm","opt","$options","initData","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","startTagClose","attribute","parseHTML","html","ELEMENT_TYPE","currentParent","root","createAstElement","tag","attrs","type","children","parent","start","node","push","advance","n","substring","parseStartTag","match","tagName","length","attr","end","name","textEnd","indexOf","startTagMatch","endTagMatch","text","defaultTagReg","genProps","str","i","obj","split","JSON","stringify","gen","codeGen","test","tokens","lastIndex","exec","index","trim","join","genChildren","map","child","ast","code","compileToFunction","template","render","Function","console","log","createElementVNode","vnode","createTextNode","undefined","createElm","el","document","createElement","patchProps","appendChild","props","styleName","style","setAttribute","patch","oldVnode","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibling","removeChild","initLifeCycle","Vue","_update","$el","_c","arguments","_v","_s","_render","mountComponent","initMixin","_init","options","$mount","querySelector","outerHTML"],"mappings":"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"}