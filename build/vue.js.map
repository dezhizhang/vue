{"version":3,"file":"vue.js","sources":["../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["\nlet oldArrayProto = Array.prototype;\n\nexport let newArrayProto = Object.create(oldArrayProto);\n\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'resolve',\n    'sort',\n    'splice'\n];\n\n\nmethods.forEach(method => {\n    newArrayProto[method] = function (...args) {\n        const result = oldArrayProto[method].call(this, ...args);\n\n        // 新增数据进行却持\n        let inserted;\n        let ob = this.__ob__;\n\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n            default:\n                break;\n        }\n\n        if(inserted) {\n            ob.observeArray(inserted);\n        }\n    }\n})","\nimport { newArrayProto } from './array';\nclass Observer {\n    constructor(data) {\n        Object.defineProperty(data, '__ob__', {\n            value: this,\n            enumerable: false,\n        });\n        if (Array.isArray(data)) {\n            data.__proto__ = newArrayProto;\n            this.observeArray(data);\n        } else {\n            this.walk(data);\n        }\n\n    }\n\n    walk(target) {\n        Object.keys(target).forEach(key => {\n            defineReactive(target, key, target[key]);\n        })\n    }\n    observeArray(data) {\n        data.forEach(item => observe(item))\n    }\n}\n\nfunction defineReactive(target, key, value) {\n    observe(value);\n    Object.defineProperty(target, key, {\n        get() {\n            return value;\n        },\n        set(newValue) {\n            if (newValue === value) return;\n            observe(newValue);\n            value = newValue;\n        }\n    })\n}\n\nexport function observe(data) {\n    if (typeof data !== 'object' || data == null) {\n        return; // 不是对像不能观测\n    }\n    if (data._ob_ instanceof Observer) {\n        return data._ob_;\n    }\n    return new Observer(data);\n}","\nimport { observe } from './observer/index';\n\nexport function initState(vm) {\n    // 获取所有的选项\n    const opt = vm.$options;\n    if(opt.data) {\n        initData(vm)\n    }\n}\n\nexport function initData(vm) {\n    let data = vm.$options.data;\n    data = vm._data = typeof data === 'function' ? data.call(vm):data;\n    observe(data);\n    console.log('data',data)\n}","import { initState } from './state';\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n\n        const vm = this;\n        vm.$options = options;\n\n        // 初始化状态\n        initState(vm);\n    }\n}\n\n","\nimport { initMixin } from './init';\n\nfunction Vue(options) {\n   this._init(options);\n}\n\ninitMixin(Vue)\n\nexport default Vue;\n"],"names":["oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","slice","observeArray","Observer","data","defineProperty","value","enumerable","isArray","__proto__","walk","target","keys","key","defineReactive","item","observe","get","set","newValue","_ob_","initState","vm","opt","$options","initData","_data","console","log","initMixin","Vue","_init","options"],"mappings":"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"}